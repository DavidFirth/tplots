#' Subsetting Grid Graphical Parameters
#
#' @param x a list of class `gpar`.
#' @param subset logical expression indicating elements to keep; missing values are taken as false.
#' @param ... ignored.
#
#' @return a list of class `gpar`.
#'
#' @details This is an S3 method for the generic [base::subset()] function, to subset graphical parameters that are vectors in a `gpar` object (a list typically produced by [grid::gpar()]).
#' @examples
#' gp <- grid::gpar(pch = 21, fill = c("red", "blue", "green"))
#' gp13 <- subset(gp, c(TRUE, FALSE, TRUE))
#' print(gp13)
#'
#' 
subset.gpar = function(x, subset, ...) {
    gp <- lapply(x, function(parameter) {
        if(length(parameter) == 1) parameter
        else parameter[subset]
    })
    class(gp) = "gpar"
    return(gp)
}


